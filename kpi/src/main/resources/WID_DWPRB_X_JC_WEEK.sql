use noce;

DROP TABLE IF EXISTS `wid_dwprb_x_jc_week`;

CREATE EXTERNAL TABLE `wid_dwprb_x_jc_week`(
    `city_id` int,
    `base_statn_id` int,
    `base_statn_name` string,
    `cell_id` int,
    `cell_name` string,
    `bs_vendor` string,
    `is_indoor` string,
    `band` string,
    `system_type_or_standard` string,
    `region` string,
    `attribute` bigint,
    `nb_flag` tinyint,
    `band_width` int,
    `dwprbmin_1` float,
    `dwprbmax_1` float,
    `dwprbsum_1` float,
    `dwprbmean_1` float,
    `dwprbmedian_1` float,
    `dwprbvar_1` float,
    `dwprbstd_1` float,
    `dwprbxmax_1` string,
    `dwprbxmin_1` string,
    `dwprbcv_1` float,
    `trough_1` string,
    `dwprbmin_2` float,
    `dwprbmax_2` float,
    `dwprbsum_2` float,
    `dwprbmean_2` float,
    `dwprbmedian_2` float,
    `dwprbvar_2` float,
    `dwprbstd_2` float,
    `dwprbxmax_2` string,
    `dwprbxmin_2` string,
    `dwprbcv_2` float,
    `trough_2` string,
    `dwprbmin_3` float,
    `dwprbmax_3` float,
    `dwprbsum_3` float,
    `dwprbmean_3` float,
    `dwprbmedian_3` float,
    `dwprbvar_3` float,
    `dwprbstd_3` float,
    `dwprbxmax_3` string,
    `dwprbxmin_3` string,
    `dwprbcv_3` float,
    `trough_3` string,
    `dwprbmin_4` float,
    `dwprbmax_4` float,
    `dwprbsum_4` float,
    `dwprbmean_4` float,
    `dwprbmedian_4` float,
    `dwprbvar_4` float,
    `dwprbstd_4` float,
    `dwprbxmax_4` string,
    `dwprbxmin_4` string,
    `dwprbcv_4` float,
    `trough_4` string,
    `dwprbmin_5` float,
    `dwprbmax_5` float,
    `dwprbsum_5` float,
    `dwprbmean_5` float,
    `dwprbmedian_5` float,
    `dwprbvar_5` float,
    `dwprbstd_5` float,
    `dwprbxmax_5` string,
    `dwprbxmin_5` string,
    `dwprbcv_5` float,
    `trough_5` string,
    `dwprbmin_6` float,
    `dwprbmax_6` float,
    `dwprbsum_6` float,
    `dwprbmean_6` float,
    `dwprbmedian_6` float,
    `dwprbvar_6` float,
    `dwprbstd_6` float,
    `dwprbxmax_6` string,
    `dwprbxmin_6` string,
    `dwprbcv_6` float,
    `trough_6` string,
    `dwprbmin_7` float,
    `dwprbmax_7` float,
    `dwprbsum_7` float,
    `dwprbmean_7` float,
    `dwprbmedian_7` float,
    `dwprbvar_7` float,
    `dwprbstd_7` float,
    `dwprbxmax_7` string,
    `dwprbxmin_7` string,
    `dwprbcv_7` float,
    `trough_7` string,
    `dwprbmin` float,
    `dwprbmax` float,
    `dwprbsum` float,
    `dwprbmean` float,
    `dwprbmedian` float,
    `dwprbvar` float,
    `dwprbstd` float,
    `dwprbxmax` int,
    `dwprbxmin` int,
    `dwprbcv` float,
    `dwprbscore01` int,
    `dwprbscore02` int,
    `dwprbscore03` int,
    `dwprbscore04` int,
    `dwprbscore05` int,
    `dwprbscore06` int,
    `dwprbscore07` int,
    `trough_num` int,
    `trough_week` string,
    `peak_week` string,
    `middle_week` string,
    `trough_week_day` string,
    `peak_week_day` string,
    `middle_week_day` string,
    `public_week_day` string
)
PARTITIONED BY (`day` bigint)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='|', 'serialization.format'='|')
STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION 'hdfs://noce1/DATA/PUBLIC/WID/WID_DWPRB_X_JC_WEEK'