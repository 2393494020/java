use noce;

DROP TABLE IF EXISTS `wid_maxrrc_x_jc_week`;

CREATE EXTERNAL TABLE `wid_maxrrc_x_jc_week`(
    `city_id` int,
    `base_statn_id` int,
    `base_statn_name` string,
    `cell_id` int,
    `cell_name` string,
    `bs_vendor` string,
    `is_indoor` string,
    `band` string,
    `system_type_or_standard` string,
    `region` string,
    `attribute` bigint,
    `nb_flag` tinyint,
    `band_width` int,
    `maxrrcmin_1` float,
    `maxrrcmax_1` float,
    `maxrrcsum_1` float,
    `maxrrcmean_1` float,
    `maxrrcmedian_1` float,
    `maxrrcvar_1` float,
    `maxrrcstd_1` float,
    `maxrrcxmax_1` string,
    `maxrrcxmin_1` string,
    `maxrrccv_1` float,
    `trough_1` string,
    `maxrrcmin_2` float,
    `maxrrcmax_2` float,
    `maxrrcsum_2` float,
    `maxrrcmean_2` float,
    `maxrrcmedian_2` float,
    `maxrrcvar_2` float,
    `maxrrcstd_2` float,
    `maxrrcxmax_2` string,
    `maxrrcxmin_2` string,
    `maxrrccv_2` float,
    `trough_2` string,
    `maxrrcmin_3` float,
    `maxrrcmax_3` float,
    `maxrrcsum_3` float,
    `maxrrcmean_3` float,
    `maxrrcmedian_3` float,
    `maxrrcvar_3` float,
    `maxrrcstd_3` float,
    `maxrrcxmax_3` string,
    `maxrrcxmin_3` string,
    `maxrrccv_3` float,
    `trough_3` string,
    `maxrrcmin_4` float,
    `maxrrcmax_4` float,
    `maxrrcsum_4` float,
    `maxrrcmean_4` float,
    `maxrrcmedian_4` float,
    `maxrrcvar_4` float,
    `maxrrcstd_4` float,
    `maxrrcxmax_4` string,
    `maxrrcxmin_4` string,
    `maxrrccv_4` float,
    `trough_4` string,
    `maxrrcmin_5` float,
    `maxrrcmax_5` float,
    `maxrrcsum_5` float,
    `maxrrcmean_5` float,
    `maxrrcmedian_5` float,
    `maxrrcvar_5` float,
    `maxrrcstd_5` float,
    `maxrrcxmax_5` string,
    `maxrrcxmin_5` string,
    `maxrrccv_5` float,
    `trough_5` string,
    `maxrrcmin_6` float,
    `maxrrcmax_6` float,
    `maxrrcsum_6` float,
    `maxrrcmean_6` float,
    `maxrrcmedian_6` float,
    `maxrrcvar_6` float,
    `maxrrcstd_6` float,
    `maxrrcxmax_6` string,
    `maxrrcxmin_6` string,
    `maxrrccv_6` float,
    `trough_6` string,
    `maxrrcmin_7` float,
    `maxrrcmax_7` float,
    `maxrrcsum_7` float,
    `maxrrcmean_7` float,
    `maxrrcmedian_7` float,
    `maxrrcvar_7` float,
    `maxrrcstd_7` float,
    `maxrrcxmax_7` string,
    `maxrrcxmin_7` string,
    `maxrrccv_7` float,
    `trough_7` string,
    `maxrrcmin` float,
    `maxrrcmax` float,
    `maxrrcsum` float,
    `maxrrcmean` float,
    `maxrrcmedian` float,
    `maxrrcvar` float,
    `maxrrcstd` float,
    `maxrrcxmax` int,
    `maxrrcxmin` int,
    `maxrrccv` float,
    `maxrrcscore01` int,
    `maxrrcscore02` int,
    `maxrrcscore03` int,
    `maxrrcscore04` int,
    `maxrrcscore05` int,
    `maxrrcscore06` int,
    `maxrrcscore07` int,
    `idleflag` int,
    `trough_num` int,
    `trough_week` string,
    `peak_week` string,
    `middle_week` string,
    `trough_week_day` string,
    `peak_week_day` string,
    `middle_week_day` string,
    `public_week_day` string
)
PARTITIONED BY (`day` bigint)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='|', 'serialization.format'='|')
STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION 'hdfs://noce1/DATA/PUBLIC/WID/WID_MAXRRC_X_JC_WEEK'