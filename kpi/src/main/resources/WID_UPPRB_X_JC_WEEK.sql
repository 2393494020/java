use noce;

DROP TABLE IF EXISTS `wid_upprb_x_jc_week`;

CREATE EXTERNAL TABLE `wid_upprb_x_jc_week`(
    `city_id` int,
    `base_statn_id` int,
    `base_statn_name` string,
    `cell_id` int,
    `cell_name` string,
    `bs_vendor` string,
    `is_indoor` string,
    `band` string,
    `system_type_or_standard` string,
    `region` string,
    `attribute` bigint,
    `nb_flag` tinyint,
    `band_width` int,
    `upprbmin_1` float,
    `upprbmax_1` float,
    `upprbsum_1` float,
    `upprbmean_1` float,
    `upprbmedian_1` float,
    `upprbvar_1` float,
    `upprbstd_1` float,
    `upprbxmax_1` string,
    `upprbxmin_1` string,
    `upprbcv_1` float,
    `trough_1` string,
    `upprbmin_2` float,
    `upprbmax_2` float,
    `upprbsum_2` float,
    `upprbmean_2` float,
    `upprbmedian_2` float,
    `upprbvar_2` float,
    `upprbstd_2` float,
    `upprbxmax_2` string,
    `upprbxmin_2` string,
    `upprbcv_2` float,
    `trough_2` string,
    `upprbmin_3` float,
    `upprbmax_3` float,
    `upprbsum_3` float,
    `upprbmean_3` float,
    `upprbmedian_3` float,
    `upprbvar_3` float,
    `upprbstd_3` float,
    `upprbxmax_3` string,
    `upprbxmin_3` string,
    `upprbcv_3` float,
    `trough_3` string,
    `upprbmin_4` float,
    `upprbmax_4` float,
    `upprbsum_4` float,
    `upprbmean_4` float,
    `upprbmedian_4` float,
    `upprbvar_4` float,
    `upprbstd_4` float,
    `upprbxmax_4` string,
    `upprbxmin_4` string,
    `upprbcv_4` float,
    `trough_4` string,
    `upprbmin_5` float,
    `upprbmax_5` float,
    `upprbsum_5` float,
    `upprbmean_5` float,
    `upprbmedian_5` float,
    `upprbvar_5` float,
    `upprbstd_5` float,
    `upprbxmax_5` string,
    `upprbxmin_5` string,
    `upprbcv_5` float,
    `trough_5` string,
    `upprbmin_6` float,
    `upprbmax_6` float,
    `upprbsum_6` float,
    `upprbmean_6` float,
    `upprbmedian_6` float,
    `upprbvar_6` float,
    `upprbstd_6` float,
    `upprbxmax_6` string,
    `upprbxmin_6` string,
    `upprbcv_6` float,
    `trough_6` string,
    `upprbmin_7` float,
    `upprbmax_7` float,
    `upprbsum_7` float,
    `upprbmean_7` float,
    `upprbmedian_7` float,
    `upprbvar_7` float,
    `upprbstd_7` float,
    `upprbxmax_7` string,
    `upprbxmin_7` string,
    `upprbcv_7` float,
    `trough_7` string,
    `upprbmin` float,
    `upprbmax` float,
    `upprbsum` float,
    `upprbmean` float,
    `upprbmedian` float,
    `upprbvar` float,
    `upprbstd` float,
    `upprbxmax` int,
    `upprbxmin` int,
    `upprbcv` float,
    `upprbscore01` int,
    `upprbscore02` int,
    `upprbscore03` int,
    `upprbscore04` int,
    `upprbscore05` int,
    `upprbscore06` int,
    `upprbscore07` int,
    `trough_num` int,
    `trough_week` string,
    `peak_week` string,
    `middle_week` string,
    `trough_week_day` string,
    `peak_week_day` string,
    `middle_week_day` string,
    `public_week_day` string
)
PARTITIONED BY (`day` bigint)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='|', 'serialization.format'='|')
STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION 'hdfs://noce1/DATA/PUBLIC/WID/WID_UPPRB_X_JC_WEEK'