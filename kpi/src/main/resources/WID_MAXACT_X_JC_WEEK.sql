use noce;

DROP TABLE IF EXISTS `wid_maxact_x_jc_week`;

CREATE EXTERNAL TABLE `wid_maxact_x_jc_week`(
    `city_id` int,
    `base_statn_id` int,
    `base_statn_name` string,
    `cell_id` int,
    `cell_name` string,
    `bs_vendor` string,
    `is_indoor` string,
    `band` string,
    `system_type_or_standard` string,
    `region` string,
    `attribute` bigint,
    `nb_flag` tinyint,
    `band_width` int,
    `maxactmin_1` float,
    `maxactmax_1` float,
    `maxactsum_1` float,
    `maxactmean_1` float,
    `maxactmedian_1` float,
    `maxactvar_1` float,
    `maxactstd_1` float,
    `maxactxmax_1` string,
    `maxactxmin_1` string,
    `maxactcv_1` float,
    `trough_1` string,
    `maxactmin_2` float,
    `maxactmax_2` float,
    `maxactsum_2` float,
    `maxactmean_2` float,
    `maxactmedian_2` float,
    `maxactvar_2` float,
    `maxactstd_2` float,
    `maxactxmax_2` string,
    `maxactxmin_2` string,
    `maxactcv_2` float,
    `trough_2` string,
    `maxactmin_3` float,
    `maxactmax_3` float,
    `maxactsum_3` float,
    `maxactmean_3` float,
    `maxactmedian_3` float,
    `maxactvar_3` float,
    `maxactstd_3` float,
    `maxactxmax_3` string,
    `maxactxmin_3` string,
    `maxactcv_3` float,
    `trough_3` string,
    `maxactmin_4` float,
    `maxactmax_4` float,
    `maxactsum_4` float,
    `maxactmean_4` float,
    `maxactmedian_4` float,
    `maxactvar_4` float,
    `maxactstd_4` float,
    `maxactxmax_4` string,
    `maxactxmin_4` string,
    `maxactcv_4` float,
    `trough_4` string,
    `maxactmin_5` float,
    `maxactmax_5` float,
    `maxactsum_5` float,
    `maxactmean_5` float,
    `maxactmedian_5` float,
    `maxactvar_5` float,
    `maxactstd_5` float,
    `maxactxmax_5` string,
    `maxactxmin_5` string,
    `maxactcv_5` float,
    `trough_5` string,
    `maxactmin_6` float,
    `maxactmax_6` float,
    `maxactsum_6` float,
    `maxactmean_6` float,
    `maxactmedian_6` float,
    `maxactvar_6` float,
    `maxactstd_6` float,
    `maxactxmax_6` string,
    `maxactxmin_6` string,
    `maxactcv_6` float,
    `trough_6` string,
    `maxactmin_7` float,
    `maxactmax_7` float,
    `maxactsum_7` float,
    `maxactmean_7` float,
    `maxactmedian_7` float,
    `maxactvar_7` float,
    `maxactstd_7` float,
    `maxactxmax_7` string,
    `maxactxmin_7` string,
    `maxactcv_7` float,
    `trough_7` string,
    `maxactmin` float,
    `maxactmax` float,
    `maxactsum` float,
    `maxactmean` float,
    `maxactmedian` float,
    `maxactvar` float,
    `maxactstd` float,
    `maxactxmax` int,
    `maxactxmin` int,
    `maxactcv` float,
    `maxactscore01` int,
    `maxactscore02` int,
    `maxactscore03` int,
    `maxactscore04` int,
    `maxactscore05` int,
    `maxactscore06` int,
    `maxactscore07` int,
    `idleflag` int,
    `trough_num` int,
    `trough_week` string,
    `peak_week` string,
    `middle_week` string,
    `trough_week_day` string,
    `peak_week_day` string,
    `middle_week_day` string,
    `public_week_day` string
)
PARTITIONED BY (`day` bigint)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES ('field.delim'='|', 'serialization.format'='|')
STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION 'hdfs://noce1/DATA/PUBLIC/WID/WID_MAXACT_X_JC_WEEK'